The fix reduces CPU usage from Microsoft's MsMpEng.exe by as much as 75% while using the Firefox browser, according to a Mozilla engineer. I've been with PCMag since October 2017, covering a wide range of topics, including consumer electronics, cybersecurity, social media, networking, and gaming. Prior to working at PCMag, I was a foreign correspondent in Beijing for over five years, covering the tech scene in Asia. It took over five years, but Microsoft has finally fixed a bug that caused Windows Defender to drain CPU resources when Mozilla’s Firefox browser is active.  In 2018, Mozilla staff reported that Windows 10’s built-in malware-detection program caused CPU consumption to top 30%. "This is considerably slowing me down and makes Firefox feel really slow,” Firefox designer Markus Jaritz said at the time.  According to Mozilla’s bug report, the company’s engineers reported the problem to Microsoft in June 2018, noting the slowdown issues seemed to involve a program called “MsMpEng.exe,” the malware protection engine for Defender. But it looks like Microsoft’s effort to fix the problem fizzled out—possibly because it needed more information on the bug—which resulted in no major update on the problem for years.  The problem only re-emerged in recent months after a user on Reddit again reported Windows Defender had been causing their PC to consume 30% of its CPU resources while Firefox was active. Yannis Juglaret, a Mozilla senior software engineer, then posted in Mozilla’s original bug report, this time with screenshots showing Firefox triggering the CPU spikes through MsMpEng.exe when Google’s Chrome browser would not.  “The CPU time used overall by MsMpEng.exe seems indeed much higher (5x) with Firefox compared to Chrome,” he wrote.  He then found Firefox can trigger too many CPU-heavy calls to VirtualProtect, a Windows component that’s monitored over MsMpEng.exe.  “With a standard Firefox configuration, the amount of calls to VirtualProtect is currently very high, and that is what explains the high CPU usage with Firefox,” Juglaret added. “In Firefox, disabling JIT makes MsMpEng.exe behave much more reasonably, as JIT engines are the source of the vast majority of calls to VirtualProtect.” The good news is that Microsoft has since fixed the bug by rolling out a new version of mpengine.dl, version 1.1.20200.4 last week. However, Juglaret has another note about the impact of the bug. “You may read online that Defender was making too many calls to VirtualProtect, and that global CPU usage will now go down by 75% when browsing with Firefox. This is absolutely wrong!” he wrote in a new entry on the bug report. Instead, CPU usage for the specific program MsMpEng.exe, not for the whole PC, “will consume around 75% less CPU than it did before when it is monitoring Firefox," Juglaret adds on Reddit. Microsoft didn’t immediately respond to a request for comment. Sign up for SecurityWatch newsletter for our top privacy and security stories delivered right to your inbox.  This newsletter may contain advertising, deals, or affiliate links. Subscribing to a newsletter indicates your consent to our Terms of Use and Privacy Policy. You may unsubscribe from the newsletters at any time. Your subscription has been confirmed. Keep an eye on your inbox! I've been with PCMag since October 2017, covering a wide range of topics, including consumer electronics, cybersecurity, social media, networking, and gaming. Prior to working at PCMag, I was a foreign correspondent in Beijing for over five years, covering the tech scene in Asia. Read Michael's full bio Advertisement PCMag.com is a leading authority on technology, delivering lab-based, independent reviews of the latest products and services. Our expert industry analysis and practical solutions help you make better buying decisions and get more from technology. © 1996-2024 Ziff Davis, LLC., a Ziff Davis company. All Rights Reserved. PCMag, PCMag.com and PC Magazine are among the federally registered trademarks of Ziff Davis and may not be used by third parties without explicit permission. The display of third-party trademarks and trade names on this site does not necessarily indicate any
affiliation or the endorsement of PCMag. If you click an affiliate link and buy a product or service, we may be paid a fee by that merchant.